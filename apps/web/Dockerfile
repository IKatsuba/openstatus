ARG RAILWAY_DOCKERFILE_PATH
ARG TINY_BIRD_API_KEY
ARG RESEND_API_KEY
ARG GCP_PROJECT_ID
ARG GCP_LOCATION
ARG GCP_CLIENT_EMAIL
ARG GCP_PRIVATE_KEY
ARG CRON_SECRET
ARG EXTERNAL_API_URL
ARG PLAIN_API_KEY
ARG PAGERDUTY_APP_ID
ARG CHECKER_API_URL
ARG QSTASH_CURRENT_SIGNING_KEY
ARG QSTASH_NEXT_SIGNING_KEY
ARG QSTASH_TOKEN
ARG QSTASH_URL
ARG NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY
ARG STRIPE_SECRET_KEY
ARG STRIPE_WEBHOOK_SECRET_KEY
ARG UNKEY_API_ID
ARG UNKEY_TOKEN
ARG DATABASE_URL
ARG NODE_ENV
ARG UPSTASH_REDIS_REST_TOKEN
ARG UPSTASH_REDIS_REST_URL

FROM node:20

WORKDIR /app

COPY . .

RUN echo $DATABASE_URL

RUN npm install -g pnpm
RUN pnpm install &&\
    pnpm run build

EXPOSE 3000

WORKDIR /app/apps/web


CMD ["pnpm", "start"]
